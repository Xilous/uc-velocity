# UC Velocity ERP - Backend Service Configuration
#
# SETUP INSTRUCTIONS:
# 1. Create new Railway project
# 2. Add PostgreSQL database (+ New → Database → PostgreSQL)
# 3. Add this service (+ New → GitHub Repo → select uc-velocity)
# 4. Set Root Directory to: backend
# 5. Add DATABASE_URL variable (reference from PostgreSQL)
# 6. Add CORS_ORIGINS variable with frontend URL after frontend is deployed
#
# Required Environment Variables:
#   DATABASE_URL    - PostgreSQL connection string (from Railway PostgreSQL)
#   CORS_ORIGINS    - Frontend URL for CORS (e.g., https://your-frontend.up.railway.app)

[build]
builder = "nixpacks"

[deploy]
# Run Alembic migrations before starting the app (runs once per deploy)
releaseCommand = "alembic upgrade head"
startCommand = "gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:$PORT"
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3
